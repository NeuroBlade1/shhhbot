# ربات مدیریت کانال تلگرام

ربات مدیریت کانال با قابلیت اجرا روی سرور و دارای قابلیت‌های:
- مدیریت اعضای کانال
- نمایش آمار کانال
- پاکسازی خودکار حساب‌های حذف شده
- قابلیت اتصال مجدد خودکار
- مدیریت خطا و ثبت لاگ
- امکان راه‌اندازی مجدد از راه دور

## نیازمندی‌ها

- پایتون 3.7 یا بالاتر
- کتابخانه‌های مورد نیاز:
  - python-telegram-bot
  - psutil

## نصب

1. دانلود یا کلون کردن مخزن:
```bash
git clone <آدرس مخزن>
cd <نام پوشه>
```

2. نصب وابستگی‌ها:
```bash
pip install python-telegram-bot psutil
```

3. تنظیم فایل توکن و آیدی کانال:
فایل `bot.py` را باز کرده و متغیرهای زیر را ویرایش کنید:
```python
TOKEN = "YOUR_BOT_TOKEN"  # توکن ربات خود را اینجا قرار دهید
CHANNEL_ID = "@YourChannelUsername"  # آیدی کانال خود را اینجا قرار دهید
ADMIN_ID = 123456789  # آیدی عددی ادمین را اینجا قرار دهید
```

## اجرا در حالت معمولی

برای اجرای ربات در حالت معمولی، دستور زیر را اجرا کنید:
```bash
python bot.py
```

## اجرا در حالت سرور

برای اجرای ربات در حالت سرور که قابلیت‌های پیشرفته مدیریت خطا و راه‌اندازی مجدد خودکار را فعال می‌کند، از اسکریپت `server.py` استفاده کنید:

1. راه‌اندازی سرور:
```bash
python server.py start
```

2. توقف سرور (با کلید CTRL+C)

## اجرا در پس‌زمینه (لینوکس)

برای اجرای ربات در پس‌زمینه سرور لینوکس:

1. با استفاده از `nohup`:
```bash
nohup python server.py start > /dev/null 2>&1 &
```

2. با استفاده از `screen`:
```bash
screen -S bot
python server.py start
# سپس با فشردن Ctrl+A و بعد D از screen خارج شوید
```

3. برای بازگشت به screen:
```bash
screen -r bot
```

## دستورات ربات

- `/start` - شروع کار با ربات
- `/help` - نمایش راهنمای دستورات
- `/stats` - نمایش آمار کانال
- `/refresh_stats` - به‌روزرسانی آمار کانال
- `/users` - استخراج آیدی عددی و نام کاربری همه کاربران کانال
- `/remove_deleted` - حذف کاربران با حساب حذف شده از کانال
- `/server` - نمایش وضعیت سرور و ربات
- `/restart` - راه‌اندازی مجدد ربات (فقط ادمین)

## ویژگی‌های سرور-فرندلی

- **لاگینگ پیشرفته**: ذخیره لاگ‌ها در فایل‌های جداگانه
- **ذخیره خودکار آمار**: هر 5 دقیقه یکبار
- **بازیابی خودکار از خطا**: تلاش مجدد خودکار در صورت قطع اتصال
- **مدیریت سیگنال**: پاسخ صحیح به سیگنال‌های سیستم عامل
- **نظارت بر منابع**: نمایش مصرف CPU و حافظه
- **پشتیبان‌گیری خودکار**: ایجاد نسخه پشتیبان از داده‌ها

## عیب‌یابی

1. **خطای دسترسی به فایل لاگ**:
   اطمینان حاصل کنید که پوشه `logs` وجود دارد و ربات دسترسی نوشتن در آن را دارد.

2. **مشکل اتصال به API تلگرام**:
   اطمینان حاصل کنید که سرور شما امکان اتصال به API تلگرام را دارد.

3. **خطای `ModuleNotFoundError`**:
   با استفاده از `pip install -r requirements.txt` تمام وابستگی‌ها را نصب کنید.

## ساختار پروژه

- `bot.py` - کد اصلی ربات
- `server.py` - اسکریپت مدیریت سرور
- `logs/` - پوشه ذخیره لاگ‌ها
  - `bot.log` - لاگ اصلی ربات
  - `error.log` - لاگ خطاها
  - `server.log` - لاگ سرور
- `channel_stats.json` - فایل ذخیره آمار کانال
- `README.md` - فایل راهنما

## پشتیبانی

در صورت وجود هرگونه سوال یا مشکل، از طریق بخش Issues در گیت‌هاب یا تلگرام با ما در ارتباط باشید. 